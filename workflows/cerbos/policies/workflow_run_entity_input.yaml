# Make changes to the template codegen/templates/cerbos/policies/class_name.yaml.j2 instead.
# yaml-language-server: $schema=https://api.cerbos.dev/latest/cerbos/policy/v1/Policy.schema.json
apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: "default"
  importDerivedRoles:
    - common_roles
  resource: "workflow_run_entity_input"
  rules:
    - actions: ['view']
      effect: EFFECT_ALLOW
      derivedRoles:
        - project_viewer
        - single_user_owner

    - actions: ['download', 'delete']
      effect: EFFECT_ALLOW
      derivedRoles:
        - owner

    - actions: ['create', 'update', 'view']
      effect: EFFECT_ALLOW
      derivedRoles:
        - project_member
  schemas:
    principalSchema:
      ref: cerbos:///principal.json