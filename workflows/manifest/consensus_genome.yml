workflow_name: consensus-genome
workflow_version: 3.4.17
entity_inputs:
  sample:
    name: Sample
    description: Your sample
    entity_type: sample
  sequencing_read:
    name: Sequencing Read
    description: Your sequencing read
    entity_type: sequencing_read
  reference_genome:
    name: Reference Genome
    description: Your reference genome
    entity_type: reference_genome
  taxon:
    name: Taxon
    description: Your taxon
    entity_type: taxon
raw_inputs:
  clearlabs:
    name: Used clear labs
    description: Did you use clear labs?
    kind: boolean
    default: false
  medaka_model:
    name: Medaka Model
    description: Your medaka model
    workflow_input: medaka_model
    kind: enum
    default: r941_min_high_g360
    options:
      - r941_min_high_g360
      - r941_min_fast_g303
      - r941_min_high_g303
      - r941_min_high_g330
      - r941_min_high_g340_rle
      - r941_min_high_g344
      - r941_min_high_g351
      - r103_prom_high_g360
      - r103_prom_snp_g3210
      - r103_prom_variant_g3210
      - r941_prom_fast_g303
      - r941_prom_high_g303
      - r941_prom_high_g330
      - r941_prom_high_g344
      - r941_prom_high_g360
      - r941_prom_high_g4011
      - r941_prom_snp_g303
      - r941_prom_snp_g322
      - r941_prom_snp_g360
      - r941_prom_variant_g303
      - r941_prom_variant_g322
      - r941_prom_variant_g360
  creation_source:
    name: Creation Source
    description: Which view in the CZID web app are you launching this from?
    kind: enum
    default: viral_cg_upload
    options:
      - sars_cov_2_upload
      - viral_cg_upload
      - mngs_report
input_loaders:
  - loader_name: sample
    inputs:
      - entity_input: sample
    outputs:
      - loader_output: name
        workflow_input: sample
  - loader_name: sequencing_read
    inputs:
      - entity_input: sequencing_read
    outputs:
      - loader_output: primer_bed
      - loader_output: r1_file
        workflow_input: fastqs_0 
      - loader_output: r2_file
        workflow_input: fastqs_1
  - loader_name: reference_genome
    inputs:
      - entity_input: reference_genome
    outputs:
      - loader_output: ref_fasta
      - loader_output: ref_accession_id
  - loader_name: docker_image
    outputs:
      - workflow_input: docker_image_id
  - loader_name: consensus_genomes_defaults
    inputs:
      - entity_input: sample
      - raw_input: creation_source
      - raw_input: clearlabs
    outputs:
      - workflow_input: primer_set
      - workflow_input: primer_schemes
      - workflow_input: ref_host
      - workflow_input: kraken2_db_tar_gz
      - workflow_input: ercc_fasta
      - workflow_input: filter_reads
      - workflow_input: apply_length_filter
      - workflow_input: output_refseq
      - workflow_input: output_bed
output_loaders:
  - loader_name: consensus_genome
    inputs:
      - entity_input: sample
      - entity_input: taxon
      - entity_input: sequencing_read
      - workflow_output: "consensus_genome.make_consensus_out_consensus_fa"
        loader_input: sequence
      - workflow_output: "consensus_genome.compute_stats_out_sam_depths"
        loader_input: metrics_sam_depths
      - workflow_output: "consensus_genome.quast_out_quast_tsv"
        loader_input: metrics_quast
      - workflow_output: "consensus_genome.compute_stats_out_output_stats"
        loader_input: metrics_stats
      - workflow_output: "consensus_genome.zip_outputs_out_output_zip"
        loader_input: intermediate_outputs

