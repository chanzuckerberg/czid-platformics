---
name: ContactTestSuite
description: Tests for verifying the contact resource policy

principals:
  user1:
    id: "1"
    roles:
      - user
    attr:
      user_id: 1
      admin_projects: [100]
      member_projects: [100]
  user2:
    id: "2"
    roles:
      - user
    attr:
      user_id: 2
      admin_projects: [200]
      member_projects: [300]

resources:
  user1_sample:
    kind: sample
    id: BUGS001
    attr:
      "owner_user_id": 1
      "collection_id": 100

  user2_sample:
    kind: sample
    id: DAFFY002
    attr:
      "owner_user_id": 2
      "collection_id": 200

tests:
  - name: Bugs bunny
    input:
      principals:
        - user1
        - user2

      resources:
        - user1_sample
        - user2_sample

      actions:
        - view
        - comment

    expected:
      - principal: user1
        resource: user1_sample
        actions:
          view: EFFECT_ALLOW
          comment: EFFECT_ALLOW

      - principal: user1
        resource: user2_sample
        actions:
          view: EFFECT_DENY
          comment: EFFECT_DENY

      - principal: user2
        resource: user1_sample
        actions:
          view: EFFECT_DENY
          comment: EFFECT_DENY

      - principal: user2
        resource: user2_sample
        actions:
          view: EFFECT_ALLOW
          comment: EFFECT_ALLOW
